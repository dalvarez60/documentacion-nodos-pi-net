## 4. Implementación del Nodo de Pi Network
Con tu VPS configurado con Docker y el firewall, el siguiente paso es implementar el software del nodo de Pi Network. Esto se realiza utilizando un script oficial que descarga las imágenes de Docker necesarias y configura los contenedores para el funcionamiento del nodo.

## 4.1. Obtener el Script de Instalación del Nodo Pi
El equipo de Pi Core Team proporciona un script que automatiza la descarga de las imágenes de Docker del nodo Pi y la configuración inicial. Primero, necesitamos descargar este script a tu VPS.

Instrucción para Ejecutar: Copia los siguientes comandos (uno por uno), pégalos en tu terminal SSH, y presiona Enter.

```bash
cd ~
```
Este comando te lleva a tu directorio personal (/home/tu_usuario o /root si estás como root) en el VPS. Es un buen lugar para descargar el script.

```bash
curl -L https://raw.githubusercontent.com/pi-node/pi-node-frontend/master/scripts/setup_node.sh -o setup_node.sh
```
Este comando descarga el script setup_node.sh desde el repositorio oficial de Pi Network en GitHub. La opción -L sigue redirecciones y -o setup_node.sh guarda el archivo con ese nombre en tu directorio actual.

```bash
chmod +x setup_node.sh
```
Este comando (chmod +x) le da permisos de ejecución al script setup_node.sh. Esto es necesario para poder ejecutarlo en el siguiente paso.

## 4.2. Preparación para Ejecución Persistente (Usando screen - RECOMENDADO)
Dado que la sincronización de la blockchain puede durar horas o días, es altamente recomendable ejecutar el script de instalación dentro de una sesión de screen. Esto te permitirá desconectarte de tu sesión SSH sin que el proceso se detenga en el servidor.

## 4.2.1. Instalar screen
Primero, instala screen si aún no está en tu VPS.

Instrucción para Ejecutar: Copia el siguiente comando, pégalo en tu terminal SSH, y presiona Enter.

```bash
sudo apt install screen -y
```

## 4.2.2. Iniciar una Sesión de screen
Ahora, inicia una nueva sesión de screen. Esto creará una nueva "ventana" de terminal dentro de tu VPS.

Instrucción para Ejecutar: Copia el siguiente comando, pégalo en tu terminal SSH, y presiona Enter.

```bash
screen -S pi_node_install
```
El flag -S pi_node_install le da un nombre a tu sesión (pi_node_install), lo que facilita identificarla si tienes múltiples sesiones de screen abiertas.

Verás que tu terminal se limpiará, dándote una nueva línea de comandos. Esto indica que estás dentro de la sesión de screen.

## 4.3. Ejecutar el Script de Configuración del Nodo Pi (Dentro de screen)
Ahora que estás dentro de la sesión de screen, puedes ejecutar el script de instalación del nodo. Si tu conexión SSH se cae, el script seguirá ejecutándose sin problemas en la sesión de screen en el servidor.

Instrucción para Ejecutar: Copia el siguiente comando, pégalo dentro de tu sesión de screen, y presiona Enter.

```bash
./setup_node.sh
```
Este comando ejecuta el script setup_node.sh que acabas de descargar. El script se encargará de:

1- Descargar las imágenes de Docker necesarias para el nodo de Pi (por ejemplo, Stellar Core, Pi Blockchain, etc.).
2- Crear y configurar los contenedores de Docker para el nodo.
3- Establecer los volúmenes de almacenamiento para la blockchain.
4- Iniciar los servicios del nodo.

Qué Esperar Durante la Ejecución del Script:

El script imprimirá una serie de mensajes en tu terminal. Puede que te solicite algunas confirmaciones durante el proceso (por ejemplo, para descargar imágenes grandes). Simplemente sigue las instrucciones en pantalla.

Este proceso puede tomar un tiempo considerable, especialmente la primera vez, ya que debe descargar las imágenes de Docker y comenzar la sincronización de la cadena de bloques (blockchain). La sincronización inicial de la blockchain de Stellar puede llevar horas o incluso días, dependiendo de la velocidad de tu VPS y la red.

## 4.3.1. Cómo Desconectarse (Detach) de la Sesión de screen
Una vez que el script esté ejecutándose (o si necesitas desconectarte en cualquier momento), puedes "desengancharte" de la sesión de screen sin detener los procesos en curso.

Combinación de Teclas:

1- Presiona Ctrl + A (mantén Ctrl presionado y luego presiona A).
2- Suelta Ctrl + A y luego presiona d (la letra 'd').
Verás un mensaje como [detached from ...] y volverás a tu terminal SSH normal. Tu script seguirá ejecutándose en segundo plano dentro de screen.

## 4.3.2. Cómo Volver a Conectarse (Re-attach) a la Sesión de screen
Si te has desconectado y quieres volver a ver el progreso de tu script o interactuar con él, puedes reconectarte a tu sesión de screen.

Abre una nueva sesión de Git Bash y conéctate a tu VPS vía SSH nuevamente (ssh tu_usuario@tu_ip_vps).

Una vez dentro del VPS, usa el siguiente comando:

```bash
screen -r pi_node_install
```
Si solo tienes una sesión de screen abierta, puedes usar screen -r (sin el nombre).

Si tienes múltiples sesiones y no recuerdas el nombre, puedes listarlas con:

```bash
screen -ls
```
Y luego reconectarte usando el ID o el nombre de la sesión: screen -r <ID_o_Nombre>.

[Volver al Menú Principal](Index.md)

